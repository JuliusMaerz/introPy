
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>The PsychoPy Coder, part 2 (tutorial) &#8212; introPy</title>
    
  <link rel="stylesheet" href="../_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="How to continue with PsychoPy?" href="psychopy_how_to_continue.html" />
    <link rel="prev" title="The PsychoPy Coder, part 1 (tutorial)" href="psychopy_coder_part1.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  <img src="../_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">introPy</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../index.html">
   Welcome to introPy
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Getting started
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../getting_started/about.html">
   About this course
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../getting_started/installation.html">
   Installation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../getting_started/jupyter.html">
   The Jupyter ecosystem
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Python (week 1)
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../week_1/python.html">
   Python essentials
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../solutions/week_1/0_introduction.html">
   Introduction to Python (T)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../solutions/week_1/1_python_basics.html">
   Python basics (T)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../solutions/week_1/2_matplotlib.html">
   Introduction to Matplotlib (T)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../solutions/week_1/3_pandas.html">
   Introduction to Pandas (T)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../solutions/week_1/4_numpy.html">
   Introduction to Numpy (T)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../week_1/python_how_to_continue.html">
   How to continue with Python?
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  PsychoPy (week 2)
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="psychopy.html">
   PsychoPy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="intro_psychopy.html">
   Introduction to PsychoPy (T)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="psychopy_builder_part1.html">
   PsychoPy Builder, part 1 (T)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="psychopy_builder_part2.html">
   PsychoPy Builder, part 2 (T)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="psychopy_coder_part1.html">
   PsychoPy Coder, part 1 (T)
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   PsychoPy Coder, part 2 (T)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="psychopy_how_to_continue.html">
   How to continue with PsychoPy?
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Misc
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../misc/bibliography.html">
   Bibliography
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../misc/for_developers.html">
   For developers
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../misc/CONTRIBUTING.html">
   Contributing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../misc/CONDUCT.html">
   Code of Conduct
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/week_2/psychopy_coder_part2.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/lukassnoek/introPy"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/lukassnoek/introPy/issues/new?title=Issue%20on%20page%20%2Fweek_2/psychopy_coder_part2.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        <a class="edit-button" href="https://github.com/lukassnoek/introPy/edit/master/intropy/week_2/psychopy_coder_part2.md"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#components">
   Components
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#drawin-flippin">
   Drawin’ &amp; flippin’
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#responses">
   Responses
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#keyboard-responses">
     Keyboard responses
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#mouse-responses-optional">
     Mouse responses (optional)
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#timing-revisited">
   Timing revisited
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#clock-based-timing">
     Clock-based timing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#frame-based-timing-optional">
     Frame-based timing (optional)
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#trial-loops">
   Trial loops
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#logging-onsets-optional">
   Logging onsets (optional)
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#keeping-track-of-and-saving-data">
   Keeping track of and saving data
  </a>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="the-psychopy-coder-part-2-tutorial">
<h1>The PsychoPy Coder, part 2 (tutorial)<a class="headerlink" href="#the-psychopy-coder-part-2-tutorial" title="Permalink to this headline">¶</a></h1>
<p>In the previous tutorial, we discussed most of the “administrative” stuff that needs to happen in any PsychoPy experiment. In this tutorial, we’ll discuss how to actually add components to the experiment, interact with user responses, and work with the experiment data.</p>
<div class="section" id="components">
<h2>Components<a class="headerlink" href="#components" title="Permalink to this headline">¶</a></h2>
<p>Like in the Builder, <em>components</em> are the “bread and butter” in the Coder interface as well. In the coder, however, these components are implemented in different classes from the <code class="docutils literal notranslate"><span class="pre">psychopy</span></code> package. For example, to add a text component, you can use the <code class="docutils literal notranslate"><span class="pre">TextStim</span></code> class from the <code class="docutils literal notranslate"><span class="pre">psychopy.visual</span></code> module and to add a sound component, you can use the <code class="docutils literal notranslate"><span class="pre">Sound</span></code> component from the <code class="docutils literal notranslate"><span class="pre">psychopy.sound</span></code> module.</p>
<p>Basically, every component from the Builder has an equivalent in the <code class="docutils literal notranslate"><span class="pre">psychopy</span></code> package. Moreover, each component has the same properties in the Builder as in the Coder. For example, the <em>color</em> and <em>font</em> properties from text components in the Builder are also available in the Coder interface as arguments (and attributes) of the corresponding component class. For example, to set the font of a text stim to Calibri and the text color to blue, initialize a <code class="docutils literal notranslate"><span class="pre">TextStim</span></code> object with <code class="docutils literal notranslate"><span class="pre">font='Calibri'</span></code> and <code class="docutils literal notranslate"><span class="pre">color=(-1,</span> <span class="pre">-1,</span> <span class="pre">1)</span></code>.</p>
<p>Importantly, all visual stimulus classes (like <code class="docutils literal notranslate"><span class="pre">TextStim</span></code>, but not <code class="docutils literal notranslate"><span class="pre">Sound</span></code>) additionally need one (mandatory) argument: a <code class="docutils literal notranslate"><span class="pre">Window</span></code> object! This allows to <code class="docutils literal notranslate"><span class="pre">TextStim</span></code> to interact with the window. So, let’s recap: to initialize a component in the Coder interface, we need to (1) import the corresponding class and (2) initialize it with a <code class="docutils literal notranslate"><span class="pre">Window</span></code> object (in case of visual components) and optionally other arguments that modify the component’s behavior or display.</p>
<p>Now, suppose you would like to welcome my participant by showing a short welcome message — “Welcome to this experiment!”. To do so, you’d need a <code class="docutils literal notranslate"><span class="pre">TextStim</span></code> which would need to be initialized as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">psychopy.visual</span> <span class="kn">import</span> <span class="n">TextStim</span>

<span class="c1"># We assume `win` already exists</span>
<span class="n">welcome_txt_stim</span> <span class="o">=</span> <span class="n">TextStim</span><span class="p">(</span><span class="n">win</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Welcome to this experiment!&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="attention admonition">
<p class="admonition-title"> ToDo</p>
<p>Paste the code snippet above into your script, after initializing the window and clock. Note: it’s convention to put all import statements together at the top of your script, so make sure the <code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">psychopy.visual</span> <span class="pre">import</span> <span class="pre">TextStim</span></code> part is on top of your script as well. Then, run the experiment.</p>
</div>
</div>
<div class="section" id="drawin-flippin">
<h2>Drawin’ &amp; flippin’<a class="headerlink" href="#drawin-flippin" title="Permalink to this headline">¶</a></h2>
<p>When running your experiment after including the welcome text component, however, the PsychoPy window does not show the text! This is because you first need to <em>draw</em> the stimulus! This can be done by calling the <code class="docutils literal notranslate"><span class="pre">draw</span></code> method that is included in each (visual) component class.</p>
<div class="attention admonition">
<p class="admonition-title"> ToDo</p>
<p>After initialization of the text component, call the <code class="docutils literal notranslate"><span class="pre">draw</span></code> method (without arguments) of the <code class="docutils literal notranslate"><span class="pre">welcome_txt_stim</span></code> variable. Then, run your experiment.</p>
</div>
<p>Argh, still no sign of the welcome text in the window! This is because your monitor contains <a class="reference external" href="https://en.wikipedia.org/wiki/Multiple_buffering">two buffers</a>, a “front buffer” (which is visible) and a “back buffer” (which isn’t), and components are always drawn on the back buffer! To make the drawn components visible, we need to flip the back buffer to the front, which can be done by calling the <code class="docutils literal notranslate"><span class="pre">flip</span></code> method of the <code class="docutils literal notranslate"><span class="pre">Window</span></code> object. By splitting the operation of showing stimuli into two operations (drawing and flipping the back buffer), you can precisely control when you want your stimuli to appear (i.e., when calling <code class="docutils literal notranslate"><span class="pre">flip</span></code>).</p>
<div class="attention admonition">
<p class="admonition-title"> ToDo</p>
<p>Right after the call to the <code class="docutils literal notranslate"><span class="pre">draw</span></code> method of the text component (<code class="docutils literal notranslate"><span class="pre">welcome_txt_stim</span></code>), add a call to the <code class="docutils literal notranslate"><span class="pre">flip</span></code> method (without arguments) of the window (<code class="docutils literal notranslate"><span class="pre">win</span></code>). Then, run the experiment again.</p>
</div>
<p>Finally, you should see the welcome text on the window, albeit quite briefly! Again, it is only shown briefly because PsychoPy will simply follow the script and immediatly go to the next lines (which presumably are those that close the window and quit the experiment). There are several ways in which you can specify how long a component is visible, which differ in how precisely they can determine the duration. One of the easiest ways is to add a call to the <code class="docutils literal notranslate"><span class="pre">wait</span></code> function after the window flip.</p>
<div class="attention admonition">
<p class="admonition-title"> ToDo</p>
<p>Using the <code class="docutils literal notranslate"><span class="pre">wait</span></code> function, make PsychoPy wait for 2 seconds after flipping the window. Then, run the experiment again.</p>
</div>
<p>Now you should see that the welcome text is visible for 2 seconds (actually, a bit longer because of the time it takes to shut down the experiment). In one of the next sections, we will discuss other (and more precise) methods to manipulate the duration of stimuli.</p>
<p>Note that after flipping the window such that the back buffer is moved to the front buffer, the back buffer is completely cleared. This means that when you’d flip the window <em>again</em> (without drawing any stuff in the meantime), the front buffer would contain an empty window!</p>
<div class="attention admonition">
<p class="admonition-title"> ToDo</p>
<p>After the call to the <code class="docutils literal notranslate"><span class="pre">wait</span></code> function, flip the window again, and add another call to the <code class="docutils literal notranslate"><span class="pre">wait</span></code> function for two seconds (otherwise you won’t see the effect of the second flip). Then, run the experiment again.</p>
</div>
<p>By flipping the window again, the welcome text disappeared and was replaced by an empty window (because the front buffer was replaced by an empty back buffer). This underlines an important concept: <em>every time you flip the window, you start with an empty back buffer</em> (and you need to draw your stimuli again, if you want to show them again on the next flip).</p>
</div>
<div class="section" id="responses">
<h2>Responses<a class="headerlink" href="#responses" title="Permalink to this headline">¶</a></h2>
<p>After welcoming our participant, let’s add some instructions. Like we did in the Builder experiment, let’s also make sure that, after reading the instructions, the participant can continue the experiment by pressing enter (“return”). This gives us an excuse to introduce the topic of working with participant responses!</p>
<p>But first, let’s create a <code class="docutils literal notranslate"><span class="pre">TextStim</span></code> with the instructions:</p>
<blockquote>
<div><p>In this experiment, you will see emotional faces (either happy or angry) with a word above the image (either “happy” or “angry”).
Importantly, you need to respond to the EXPRESSION of the face and ignore the word. You respond with the arrow keys:</p>
<p>HAPPY expression = left<br>
ANGRY expression = right</p>
<p>(Press ‘enter’ to start the experiment!)</p>
</div></blockquote>
<div class="attention admonition">
<p class="admonition-title"> ToDo</p>
<p>Initialize a <code class="docutils literal notranslate"><span class="pre">TextStim</span></code> object with the text above and store it in a variable named <code class="docutils literal notranslate"><span class="pre">instruct_txt_stim</span></code>. Make sure it is left-aligned and has a font size of 0.085 (check the <a class="reference external" href="https://www.psychopy.org/api/visual/textstim.html">docs</a> to see how to do this). Then, draw the <code class="docutils literal notranslate"><span class="pre">TextStim</span></code> and flip the window to make it visible!</p>
<p>Tip: you can create multi-line strings easily by enclosing text in triple-quotes, e.g., <code class="docutils literal notranslate"><span class="pre">&quot;&quot;&quot;</span> <span class="pre">some</span> <span class="pre">multiline</span> <span class="pre">text</span> <span class="pre">etc</span> <span class="pre">etc</span> <span class="pre">&quot;&quot;&quot;</span></code> (more info <a class="reference external" href="https://stackoverflow.com/questions/10660435/pythonic-way-to-create-a-long-multi-line-string">here</a>). Then, call its <code class="docutils literal notranslate"><span class="pre">draw</span></code> method, flip the window to make it visible.</p>
</div>
<div class="section" id="keyboard-responses">
<h3>Keyboard responses<a class="headerlink" href="#keyboard-responses" title="Permalink to this headline">¶</a></h3>
<p>Now, just like we added a Keyboard component in the Builder tutorials to interact with keyboard responses, we can use the <code class="docutils literal notranslate"><span class="pre">Keyboard</span></code> class from the <code class="docutils literal notranslate"><span class="pre">psychopy.hardware.keyboard</span></code> module to do the same in the Coder interface! <a class="reference external" href="https://www.psychopy.org/api/hardware/keyboard.html">This class</a> has a method called <code class="docutils literal notranslate"><span class="pre">getKeys</span></code>, which will return a list <code class="docutils literal notranslate"><span class="pre">KeyPress</span></code> objects with information (as attributes) about the keys pressed since the last time <code class="docutils literal notranslate"><span class="pre">getKeys</span></code> was pressed.</p>
<p>To implement the “wait-for-key-to-continue” routine, we can keep querying the <code class="docutils literal notranslate"><span class="pre">getKeys</span></code> method until we detect a “return” key, after which we continue the experiment.</p>
<div class="attention admonition">
<p class="admonition-title"> ToDo</p>
<p>Let’s try to implement this! Import the <code class="docutils literal notranslate"><span class="pre">Keyboard</span></code> class at the top of your script and initialize a <code class="docutils literal notranslate"><span class="pre">Keyboard</span></code> object. Then, after drawing the instruction text (and the window flip), write some code that continually queries the <code class="docutils literal notranslate"><span class="pre">getKeys</span></code> function until it detects a “return” keypress and only then continues the script. Hint: a <code class="docutils literal notranslate"><span class="pre">while</span></code> loop (with a “break”) would be useful here!</p>
<p>When you’re done, run the experiment!</p>
<details class="sphinx-bs dropdown card mb-3">
<summary class="summary-title card-header">
Click here to show the solution (but try it yourself first!)<div class="summary-down docutils">
<svg version="1.1" width="24" height="24" class="octicon octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="summary-up docutils">
<svg version="1.1" width="24" height="24" class="octicon octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="summary-content card-body docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">kb</span> <span class="o">=</span> <span class="n">Keyboard</span><span class="p">()</span>  <span class="c1"># initialize keyboard obj</span>
<span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
    <span class="c1"># getKeys returns a list (here: `keys`)</span>
    <span class="n">keys</span> <span class="o">=</span> <span class="n">kb</span><span class="o">.</span><span class="n">getKeys</span><span class="p">()</span>

    <span class="c1"># check if the return key is in the list</span>
    <span class="k">if</span> <span class="s1">&#39;return&#39;</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
        <span class="c1"># If so, break out of the loop!</span>
        <span class="k">break</span>
</pre></div>
</div>
</div>
</details></div>
<p>If you want to learn a little more about keyboard interaction, try the next (optional and more difficult) ToDo!</p>
<div class="attention admonition">
<p class="admonition-title"> ToDo (optional/difficult)</p>
<p>As mentioned before, the <code class="docutils literal notranslate"><span class="pre">getKeys</span></code> method returns a list of <code class="docutils literal notranslate"><span class="pre">KeyPress</span></code> objects. These objects contain several attributes with information about the key press: its name (<code class="docutils literal notranslate"><span class="pre">.name</span></code>, e.g., “return”), the reaction time in seconds relative to the initialization of the <code class="docutils literal notranslate"><span class="pre">Keyboard</span></code> class (<code class="docutils literal notranslate"><span class="pre">.rt</span></code>), the time in seconds the key went down in absolute time (<code class="docutils literal notranslate"><span class="pre">.tDown</span></code>), and the duration of the keypress (<code class="docutils literal notranslate"><span class="pre">.duration</span></code>).</p>
<p>For each detected key press, print in a single statement the name of the key, its reaction time, and duration (e.g., “The ‘a’ key was pressed within 2.156 seconds for a total of 0.255 seconds”). Using <a class="reference external" href="https://realpython.com/python-f-strings/">F-strings</a> would we nice here!</p>
</div>
</div>
<div class="section" id="mouse-responses-optional">
<h3>Mouse responses (optional)<a class="headerlink" href="#mouse-responses-optional" title="Permalink to this headline">¶</a></h3>
<p>Instead of interacting through the keyboard, you can interact with mouse responses of the participant. Whether you have participants respond with keyboard presses or with the mouse is of course up to you (and depends on your experiment)! For the sake of explaining how to implement interaction with mouse responses, let’s add another screen to our experiments with a big, red button, which the participant has to click (with the mouse) in order to start the experiment.</p>
<p>Just like with keyboard responses, the <code class="docutils literal notranslate"><span class="pre">psychopy</span></code> package contains a class, <code class="docutils literal notranslate"><span class="pre">Mouse</span></code> (from <code class="docutils literal notranslate"><span class="pre">psychopy.event</span></code>), which implements interaction with the mouse. As can been seen in <a class="reference external" href="https://www.psychopy.org/api/event.html">the documentation</a>, a <code class="docutils literal notranslate"><span class="pre">Mouse</span></code> object can be initialized with several optional arguments (<code class="docutils literal notranslate"><span class="pre">visible</span></code>, <code class="docutils literal notranslate"><span class="pre">newPos</span></code>, and <code class="docutils literal notranslate"><span class="pre">win</span></code>) and contains various methods to query information about the mouse position (<code class="docutils literal notranslate"><span class="pre">getPos</span></code>) and mouse clicks/presses (<code class="docutils literal notranslate"><span class="pre">getPressed</span></code>). You can even set the position of the mouse (<code class="docutils literal notranslate"><span class="pre">setPos</span></code>) and make the mouse (temporarily) (in)visible (<code class="docutils literal notranslate"><span class="pre">setVisible</span></code>)!</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>In the <a class="reference external" href="https://www.psychopy.org/api/event.html">documentation of the <code class="docutils literal notranslate"><span class="pre">psychopy.event</span></code> module</a>, you can also see several functions for keyboard interaction, such as <code class="docutils literal notranslate"><span class="pre">waitKeys</span></code> and <code class="docutils literal notranslate"><span class="pre">getKeys</span></code>, which overlap in functionality with the previously discussed <code class="docutils literal notranslate"><span class="pre">keyboard</span></code> class. <a class="reference external" href="https://discourse.psychopy.org/t/3-ways-to-get-keyboard-input-which-is-best/11184">It is recommended</a> to use the <code class="docutils literal notranslate"><span class="pre">keyboard</span></code> class instead of the functions from the <code class="docutils literal notranslate"><span class="pre">event</span></code> module!</p>
</div>
<p>Alright, let’s start with our implementation. First, we need to import the <code class="docutils literal notranslate"><span class="pre">Mouse</span></code> class and initialize a <code class="docutils literal notranslate"><span class="pre">Mouse</span></code> object.</p>
<div class="attention admonition">
<p class="admonition-title"> ToDo</p>
<p>Import the <code class="docutils literal notranslate"><span class="pre">Mouse</span></code> class at the top of your script and then initialize a <code class="docutils literal notranslate"><span class="pre">Mouse</span></code> object. Importantly, as indicated in the documentation, initialization should be done <em>after</em> initializing your <code class="docutils literal notranslate"><span class="pre">Window</span></code> object. Using the <code class="docutils literal notranslate"><span class="pre">visible</span></code> argument when initializing the <code class="docutils literal notranslate"><span class="pre">Mouse</span></code> object, make sure the mouse is initially invisible (check the <a class="reference external" href="https://www.psychopy.org/api/event.html">docs</a>).</p>
</div>
<p>We also need to create a big, red button for the participant to click! To create shapes using the <code class="docutils literal notranslate"><span class="pre">psychopy</span></code> package, you can use the <a class="reference external" href="https://www.psychopy.org/api/visual/shapestim.html#psychopy.visual.ShapeStim"><code class="docutils literal notranslate"><span class="pre">ShapeStim</span></code></a> class. This is a very broad class that allows you to create arbitrary shapes, like lines and polygons, by specifying the <a class="reference external" href="https://en.wikipedia.org/wiki/Vertex_(geometry)">vertices</a> of the shape. Specifying the vertices of a circle is quite time intensive, so you can use the more “specialized” <code class="docutils literal notranslate"><span class="pre">Polygon</span></code> or <code class="docutils literal notranslate"><span class="pre">Circle</span></code> classes instead.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Technically, the <code class="docutils literal notranslate"><span class="pre">Circle</span></code> class is a <a class="reference external" href="https://pybit.es/python-subclasses.html">subclass</a> of the <code class="docutils literal notranslate"><span class="pre">Polygon</span></code> class, and the <code class="docutils literal notranslate"><span class="pre">Polygon</span></code> class is itself a subclass of the <code class="docutils literal notranslate"><span class="pre">ShapeStim</span></code> class. Being a subclass of another class means that the subclass “inherits” all methods from its “parent class” (but possibly with different default arguments). The subclass itself may, of course, contain additional or different methods and attributes.</p>
</div>
<div class="attention admonition">
<p class="admonition-title"> ToDo</p>
<p>Add a big red button to the experiment using the <code class="docutils literal notranslate"><span class="pre">Polygon</span></code> or <code class="docutils literal notranslate"><span class="pre">Circle</span></code> class (up to you), store it in a variable named <code class="docutils literal notranslate"><span class="pre">button</span></code>, and draw it. As the <code class="docutils literal notranslate"><span class="pre">Polygon</span></code> and <code class="docutils literal notranslate"><span class="pre">Circle</span></code> classes are subclasses of the <code class="docutils literal notranslate"><span class="pre">ShapeStim</span></code> class, check out the <a class="reference external" href="https://www.psychopy.org/api/visual/shapestim.html#psychopy.visual.ShapeStim">ShapeStim documentation</a> to see which arguments those classes take.</p>
<details class="sphinx-bs dropdown card mb-3">
<summary class="summary-title card-header">
Click here to show the solution (but try it yourself first!)<div class="summary-down docutils">
<svg version="1.1" width="24" height="24" class="octicon octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="summary-up docutils">
<svg version="1.1" width="24" height="24" class="octicon octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="summary-content card-body docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">psychopy.visual</span> <span class="kn">import</span> <span class="n">Circle</span>  <span class="c1"># or Polygon</span>

<span class="c1"># You may need to adjust the size if you have a rectangular screen (which is common)</span>
<span class="c1"># to get a circle instead of an oval</span>
<span class="n">button</span> <span class="o">=</span> <span class="n">Circle</span><span class="p">(</span><span class="n">win</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">),</span> <span class="n">fillColor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>

<span class="c1"># Alternatively:</span>
<span class="c1"># button = Polygon(edges=100, size=(0.25, 0.25), fillColor=(1, -1, -1))</span>
<span class="n">button</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details></div>
<p>Showing the participant the red button by itself may be a bit confusing, so let’s add a <code class="docutils literal notranslate"><span class="pre">TextStim</span></code> with the text <code class="docutils literal notranslate"><span class="pre">&quot;Click</span> <span class="pre">the</span> <span class="pre">red</span> <span class="pre">button</span> <span class="pre">to</span> <span class="pre">start</span> <span class="pre">the</span> <span class="pre">experiment&quot;</span></code>!</p>
<div class="attention admonition">
<p class="admonition-title"> ToDo</p>
<p>Add a <code class="docutils literal notranslate"><span class="pre">TextStim</span></code> as outlined above. Make sure it doesn’t overlap with the red button! Draw it and flip the window. Then, run the experiment to see whether it works.</p>
</div>
<p>At this moment, the only thing we need to implement is a routine that halts the experiment until the participant clicked on the button using their mouse. <a class="reference external" href="https://www.psychopy.org/api/event.html">As described in the documention</a>, the <code class="docutils literal notranslate"><span class="pre">Mouse</span></code> class contains a very useful method, <code class="docutils literal notranslate"><span class="pre">isPressedIn</span></code>, which takes a <code class="docutils literal notranslate"><span class="pre">ShapeStim</span></code> (or a <code class="docutils literal notranslate"><span class="pre">ShapeStim</span></code> subclass) as input and returns a boolean (<code class="docutils literal notranslate"><span class="pre">True</span></code> or <code class="docutils literal notranslate"><span class="pre">False</span></code>) referring to whether the mouse is currently clicking in the area of the shape.</p>
<div class="attention admonition">
<p class="admonition-title"> ToDo</p>
<p>Add code that halts the experiment until the participant clicked the red button. Again, a while loop may be useful in this routine! Also, make sure the mouse disappears after the participant clickerd the button (check out the <a class="reference external" href="https://www.psychopy.org/api/event.html">docs</a> to see how to do this).</p>
<details class="sphinx-bs dropdown card mb-3">
<summary class="summary-title card-header">
Click here to show the solution (but try it yourself first!)<div class="summary-down docutils">
<svg version="1.1" width="24" height="24" class="octicon octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="summary-up docutils">
<svg version="1.1" width="24" height="24" class="octicon octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="summary-content card-body docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">mouse</span><span class="o">.</span><span class="n">isPressedIn</span><span class="p">(</span><span class="n">button</span><span class="p">):</span>
        <span class="n">mouse</span><span class="o">.</span><span class="n">setVisible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">break</span>
</pre></div>
</div>
</div>
</details><p>When you’re done, run the experiment to see whether it works!</p>
</div>
</div>
</div>
<div class="section" id="timing-revisited">
<h2>Timing revisited<a class="headerlink" href="#timing-revisited" title="Permalink to this headline">¶</a></h2>
<p>Alright, now it’s time for the most important part of our experiments: the trial loop! Just like the color-word Stroop experiment we implemented in the Builder, we’d like to create a set of trials in our emotion-word Stroop experiment. This also provides us with a nice opportunity to talk about duration and timing again!</p>
<p>Often, you’d like to make sure your trials/stimuli are presented for a specific duration. This is often especially important for perception and psychophysics studies or neuroimaging studies in which you track stimulus processing at high temporal resolution (e.g., EEG/MEG and eyetracking studies).</p>
<p>So far, we only showed you how to use the <code class="docutils literal notranslate"><span class="pre">wait</span></code> function to control stimulus duration. There are, however, two other and more precise methods, which we’ll call <em>clock-based</em> timing and <em>frame-based</em> timing. We’ll discuss these two methods in turn. But first, let’s create a stimulus. As we’re creating an emotion-word Stroop task, we’ll need an image with a emotional facial expression and an emotion word.</p>
<p>To create an image, you can use the <a class="reference external" href="https://www.psychopy.org/api/visual/imagestim.html"><code class="docutils literal notranslate"><span class="pre">ImageStim</span></code></a> class from the <code class="docutils literal notranslate"><span class="pre">psychopy.visual</span></code> module. Apart from the mandatory argument <code class="docutils literal notranslate"><span class="pre">win</span></code> (the current window), it also needs an <code class="docutils literal notranslate"><span class="pre">image</span></code> (a path to the image file). In the <code class="docutils literal notranslate"><span class="pre">tutorials/week_2</span></code> directory, we included two images: <code class="docutils literal notranslate"><span class="pre">angry.png</span></code> and <code class="docutils literal notranslate"><span class="pre">happy.png</span></code>. Note that these images are smileys, because it’s really hard to find proper facial expression stimuli without copyright …</p>
<div class="attention admonition">
<p class="admonition-title"> ToDo</p>
<p>Import the <code class="docutils literal notranslate"><span class="pre">ImageStim</span></code> class, initialize an <code class="docutils literal notranslate"><span class="pre">ImageStim</span></code> object with the <code class="docutils literal notranslate"><span class="pre">angry.png</span></code> file (store this is in a variable with the name <code class="docutils literal notranslate"><span class="pre">stim_img</span></code>), and draw it. Also create a <code class="docutils literal notranslate"><span class="pre">TextStim</span></code> with the word “happy” placed above the smiley (store this is in a variable with the name <code class="docutils literal notranslate"><span class="pre">stim_txt</span></code>) and draw it. Then, flip the window and run the experiment to see whether it works as expected.</p>
<details class="sphinx-bs dropdown card mb-3">
<summary class="summary-title card-header">
Click here to show the solution (but try it yourself first!)<div class="summary-down docutils">
<svg version="1.1" width="24" height="24" class="octicon octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="summary-up docutils">
<svg version="1.1" width="24" height="24" class="octicon octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="summary-content card-body docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">stim_img</span> <span class="o">=</span> <span class="n">ImageStim</span><span class="p">(</span><span class="n">win</span><span class="p">,</span> <span class="n">image</span><span class="o">=</span><span class="s1">&#39;angry.png&#39;</span><span class="p">)</span>
<span class="n">stim_img</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
<span class="n">stim_txt</span> <span class="o">=</span> <span class="n">TextStim</span><span class="p">(</span><span class="n">win</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;happy&#39;</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">))</span>
<span class="n">stim_txt</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
<span class="n">win</span><span class="o">.</span><span class="n">flip</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details></div>
<p>Now, suppose we want to show the image/text for a specific duration, let’s say 500 milliseconds, after which it disappears and the participant has to make a response for the experiment to continue. (Note that this is different from the way we implemented the color-word Stroop experiment in the Builder tutorials.) One way to specify the duration is using a clock!</p>
<div class="section" id="clock-based-timing">
<h3>Clock-based timing<a class="headerlink" href="#clock-based-timing" title="Permalink to this headline">¶</a></h3>
<p>In the previous tutorial, we defined a “clock” (using the <code class="docutils literal notranslate"><span class="pre">psychopy.core.Clock</span></code> class) to do some trivial timing checks, but they can be used in much more useful ways, like controlling the duration of stimuli. To showcase this, let’s create a new “trial clock” just after we flipped the window, which visualized the emotion-word trial:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">trial_clock</span> <span class="o">=</span> <span class="n">Clock</span><span class="p">()</span>
</pre></div>
</div>
<p>Now, using a while loop in combination with continuously calling the <code class="docutils literal notranslate"><span class="pre">getTime</span></code> method, we can keep showing the stimulus until the clock has passed 500 milliseconds.</p>
<div class="attention admonition">
<p class="admonition-title"> ToDo</p>
<p>Try implementing the aforementioned while loop such that the image/text of the trial is visible for 300 milliseconds and disappears afterwards. Hint: if you don’t want to execute anything inside the while loop, you can use the keyword <code class="docutils literal notranslate"><span class="pre">pass</span></code>. This is necessary, because a loop in Python can’t ever be completely “empty”. Also, make sure the image/text actually disappears after</p>
<details class="sphinx-bs dropdown card mb-3">
<summary class="summary-title card-header">
Click here to show the solution (but try it yourself first!)<div class="summary-down docutils">
<svg version="1.1" width="24" height="24" class="octicon octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="summary-up docutils">
<svg version="1.1" width="24" height="24" class="octicon octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="summary-content card-body docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">trial_clock</span> <span class="o">=</span> <span class="n">Clock</span><span class="p">()</span>
<span class="k">while</span> <span class="n">trial_clock</span><span class="o">.</span><span class="n">getTime</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mf">0.3</span><span class="p">:</span>
    <span class="k">pass</span>

<span class="c1"># We need to flip the window to actually make the stimuli disappear!</span>
<span class="n">win</span><span class="o">.</span><span class="n">flip</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details></div>
<p>Note that there is no need for our stimuli to be redrawn and our window to be flipped every iteration of the while loop! This is only necessary when you want to update your stimuli in the meantime (or when using the frame-based timing method, as discussed next).</p>
</div>
<div class="section" id="frame-based-timing-optional">
<h3>Frame-based timing (optional)<a class="headerlink" href="#frame-based-timing-optional" title="Permalink to this headline">¶</a></h3>
<p>Although the clock-based method is reasonably accurate, it implicitly assumes that stimulus duration is <em>continuous</em>, while in reality it is discrete because it can only be drawn a specific number of screen refreshes! In other words, the <em>exact</em> duration of visual stimuli is some multiple of the number of screen refreshes. For example, if you have a 60 Hz screen (which refreshes every 1/60 seconds), a stimulus can be shown for 0.0167 seconds (1/60), 0.0333 seconds (2/60), 0.0500 seconds (3/60), etc. But it cannot be shown for, let’s say, <em>exactly</em> 110 milliseconds.</p>
<div class="attention admonition">
<p class="admonition-title"> ToThink</p>
<p>Suppose you want to show a stimulus for 120 milliseconds on a monitor with a refresh rate of 60 Hz. What is the duration closest to 120 milliseconds you can achieve?</p>
<details class="sphinx-bs dropdown card mb-3">
<summary class="summary-title card-header">
Click here to see the answer (but try to come up with the answer yourself first)!<div class="summary-down docutils">
<svg version="1.1" width="24" height="24" class="octicon octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="summary-up docutils">
<svg version="1.1" width="24" height="24" class="octicon octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="summary-content card-body docutils">
<p class="card-text">Dividing 120 milliseconds (0.120 seconds) by the refresh rate (1/60) you do not get a whole (integer) number, 7.2, meaning that 7 frames/flips is the best we can do, which results in 7 * (1/60) = 0.1167 seconds.</p>
</div>
</details></div>
<p>So, if you <em>really</em> care about the duration of your stimuli (e.g., in subliminal perception studies), you should specify the duration of your stimuli as a multiple of your refresh rate. Then, to implement this in your PsychoPy script, you can simply draw your stimuli and flip your window as often as the number of frames you want to show your stimuli. For example, if you want to show your stimulus for 60 frames (i.e., 1
second on a 60 Hz monitor), you simply do the drawing + flipping process 60 times!</p>
<div class="attention admonition">
<p class="admonition-title"> ToDo</p>
<p>Remove the your clock-based timing implementation (i.e., the while loop from the previous ToDo) and instead program a frame-based timing implementation instead (the duration should be 300 ms again). Hint: a for loop could be quite useful here!</p>
<details class="sphinx-bs dropdown card mb-3">
<summary class="summary-title card-header">
Click here to show the solution (but try it yourself first!)<div class="summary-down docutils">
<svg version="1.1" width="24" height="24" class="octicon octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="summary-up docutils">
<svg version="1.1" width="24" height="24" class="octicon octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="summary-content card-body docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># 18 frames on a 60Hz monitor is 300 ms</span>
<span class="k">for</span> <span class="n">frame</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">18</span><span class="p">):</span>
    <span class="c1"># Draw stims again</span>
    <span class="n">stim_img</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
    <span class="n">stim_txt</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
    <span class="c1"># Flip window to make visible</span>
    <span class="n">win</span><span class="o">.</span><span class="n">flip</span><span class="p">()</span>

<span class="c1"># We need to flip the window to actually make the stimuli disappear!</span>
<span class="n">win</span><span class="o">.</span><span class="n">flip</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details></div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Instead of re-drawing your stimuli every iteration of the loop across frames, you can also set the attribute <code class="docutils literal notranslate"><span class="pre">autoDraw</span></code> of visual components to <code class="docutils literal notranslate"><span class="pre">True</span></code>. This will automatically draw those stimuli upon flipping the window, until you set this attribute to <code class="docutils literal notranslate"><span class="pre">False</span></code> again!</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>For timing precision, it is very important that no other (CPU-heavy) programs are running while you’re running your experiment! So make sure that, when you conduct actual experiments, you shut down all non-essential programs before starting your experiment.</p>
</div>
</div>
</div>
<div class="section" id="trial-loops">
<h2>Trial loops<a class="headerlink" href="#trial-loops" title="Permalink to this headline">¶</a></h2>
<p>So far, we only presented a single trial with a emotion word (“happy”) and a(n angry) smiley. Like the color-word Stroop in the Builder tutorial, we’d like to present the participant multiple trials in which the two factors — emotion of the smiley (happy/angry) and the emotion word (“happy”/”angry”) — vary.</p>
<p>So how do we define the different conditions? One way would be two create two lists, one with emotion words and one with the emotion for the smileys, and to choose a random value of each list in each iteration of the trial loop. In such a simple experiment, however, we would recommend to pre-specify the conditions in a CSV or Excel file &amp;mdash just like we did in the Builder tutorial.</p>
<div class="attention admonition">
<p class="admonition-title"> ToDo</p>
<p>Create a CSV or Excel file with two columns (named <code class="docutils literal notranslate"><span class="pre">smiley</span></code> and <code class="docutils literal notranslate"><span class="pre">word</span></code>) and twenty rows (excluding column names) with either “happy” or “angry” such that there are five trials of each possible emotion-word combination (just like you did in the Builder tutorial). Save it in the same directory as your Python script with the same <code class="docutils literal notranslate"><span class="pre">emo_conditions.xlsx</span></code> (or <code class="docutils literal notranslate"><span class="pre">emo_conditions.csv</span></code>). (If you want to see the “solution”, check out the <code class="docutils literal notranslate"><span class="pre">emo_conditions.xlsx</span></code> file in the <code class="docutils literal notranslate"><span class="pre">solutions/week_1</span></code> directory of the course materials).</p>
</div>
<p>To load in the data, we can use our <em>pandas</em> skills! In case of a CSV file, we can use the <code class="docutils literal notranslate"><span class="pre">read_csv</span></code> function and in case of an Excel file, we can use the <code class="docutils literal notranslate"><span class="pre">read_excel</span></code> function.</p>
<div class="attention admonition">
<p class="admonition-title"> ToDo</p>
<p>Read in your <code class="docutils literal notranslate"><span class="pre">emo_conditions.{csv,xlsx}</span></code> file and store the resulting <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> object in a variable named <code class="docutils literal notranslate"><span class="pre">cond_df</span></code> (“conditions dataframe”).</p>
</div>
<p>We could start writing our trial loop by now, but this would present the trials just like we defined in the conditions file. Often, you’d want to present the trials in a (semi-)random order. To do so, we can simply shuffle the dataframe, which can be easily done using the <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.sample.html"><code class="docutils literal notranslate"><span class="pre">sample</span></code> method</a> of <code class="docutils literal notranslate"><span class="pre">DataFrames</span></code> using a fraction (<code class="docutils literal notranslate"><span class="pre">frac</span></code>) of 1:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">cond_df</span> <span class="o">=</span> <span class="n">cond_df</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">frac</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>This method randomly samples all rows (because <code class="docutils literal notranslate"><span class="pre">frac=1</span></code>) from the dataframe, which is the same as shuffling it. The next step is to start writing a our trial loop! Because we have a fixed number of trials, we can use a for loop across the rows of our dataframe. The <code class="docutils literal notranslate"><span class="pre">iterrows</span></code> method of dataframes generates, row by row, the index and the row itself (as a <code class="docutils literal notranslate"><span class="pre">Series</span></code> object), so it’s perfect for our purposes:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">cond_df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="c1"># Extract current word and smiley</span>
    <span class="n">curr_word</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;word&#39;</span><span class="p">]</span>
    <span class="n">curr_smil</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;smiley&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>Then, after extracting the smiley and word conditions, we can initialize a <code class="docutils literal notranslate"><span class="pre">TextStim</span></code> with the current word and an <code class="docutils literal notranslate"><span class="pre">ImageStim</span></code> with the current smiley, draw them, flip the window and wait for as long as we want to show the stimulus, and repeat this process until our trial loop has finished!</p>
<div class="attention admonition">
<p class="admonition-title"> ToDo</p>
<p>Try finishing the loop in the previous code snippet as indicated above. For now, assume a duration 500 milliseconds. Run the experiment when you’re done!</p>
<details class="sphinx-bs dropdown card mb-3">
<summary class="summary-title card-header">
Click here to show the solution (but try it yourself first!)<div class="summary-down docutils">
<svg version="1.1" width="24" height="24" class="octicon octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="summary-up docutils">
<svg version="1.1" width="24" height="24" class="octicon octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="summary-content card-body docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">cond_df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="c1"># Extract current word and smiley</span>
    <span class="n">curr_word</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;word&#39;</span><span class="p">]</span>
    <span class="n">curr_smil</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;smiley&#39;</span><span class="p">]</span>

    <span class="c1"># Create and draw text/img</span>
    <span class="n">stim_txt</span> <span class="o">=</span> <span class="n">TextStim</span><span class="p">(</span><span class="n">win</span><span class="p">,</span> <span class="n">curr_word</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">))</span>
    <span class="n">stim_txt</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
    <span class="n">stim_img</span> <span class="o">=</span> <span class="n">ImageStim</span><span class="p">(</span><span class="n">win</span><span class="p">,</span> <span class="n">curr_smil</span> <span class="o">+</span> <span class="s1">&#39;.png&#39;</span><span class="p">)</span>
    <span class="n">stim_img</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

    <span class="c1"># Show</span>
    <span class="n">win</span><span class="o">.</span><span class="n">flip</span><span class="p">()</span>
    
    <span class="c1"># Wait a bit</span>
    <span class="n">wait</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details></div>
<p>At this point, the stimuli are following each other instantly! It would be nice to have a, let’s say, 1.5 second interstimulus interval (ISI) between each trial showing a fixation target.</p>
<div class="attention admonition">
<p class="admonition-title"> ToDo</p>
<p>Add code to the loop to show a simple plus sign (+) as a fixation target during the ISI.</p>
<details class="sphinx-bs dropdown card mb-3">
<summary class="summary-title card-header">
Click here to show the solution (but try it yourself first!)<div class="summary-down docutils">
<svg version="1.1" width="24" height="24" class="octicon octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="summary-up docutils">
<svg version="1.1" width="24" height="24" class="octicon octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="summary-content card-body docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># No need to define the fix inside the loop, because it doesn&#39;t change!</span>
<span class="n">fix</span> <span class="o">=</span> <span class="n">TextStim</span><span class="p">(</span><span class="n">win</span><span class="p">,</span> <span class="s1">&#39;+&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">cond_df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="c1"># Extract current word and smiley</span>
    <span class="n">curr_word</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;word&#39;</span><span class="p">]</span>
    <span class="n">curr_smil</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;smiley&#39;</span><span class="p">]</span>

    <span class="c1"># Create and draw text/img</span>
    <span class="n">stim_txt</span> <span class="o">=</span> <span class="n">TextStim</span><span class="p">(</span><span class="n">win</span><span class="p">,</span> <span class="n">curr_word</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">))</span>
    <span class="n">stim_txt</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
    <span class="n">stim_img</span> <span class="o">=</span> <span class="n">ImageStim</span><span class="p">(</span><span class="n">win</span><span class="p">,</span> <span class="n">curr_smil</span> <span class="o">+</span> <span class="s1">&#39;.png&#39;</span><span class="p">)</span>
    <span class="n">stim_img</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

    <span class="c1"># Show</span>
    <span class="n">win</span><span class="o">.</span><span class="n">flip</span><span class="p">()</span>
    
    <span class="c1"># Wait a bit</span>
    <span class="n">wait</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>

    <span class="n">fix</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
    <span class="n">win</span><span class="o">.</span><span class="n">flip</span><span class="p">()</span>
    <span class="n">wait</span><span class="p">(</span><span class="mf">1.5</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details></div>
<p>Voilà, that’s all you need for the trial loop! [Something about responses]</p>
</div>
<div class="section" id="logging-onsets-optional">
<h2>Logging onsets (optional)<a class="headerlink" href="#logging-onsets-optional" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="keeping-track-of-and-saving-data">
<h2>Keeping track of and saving data<a class="headerlink" href="#keeping-track-of-and-saving-data" title="Permalink to this headline">¶</a></h2>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./week_2"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="psychopy_coder_part1.html" title="previous page">The PsychoPy Coder, part 1 (tutorial)</a>
    <a class='right-next' id="next-link" href="psychopy_how_to_continue.html" title="next page">How to continue with PsychoPy?</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Lukas Snoek<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../_static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>